<div class="content-wrapper">
  <div class="page-header">
    <p>Lista de Recibos</p>

    <span (click)="onBack()" class="back-arrow">
      <nz-icon nzTheme="outline" nzType="arrow-left"></nz-icon>
    </span>
  </div>

  <div class="filters-panel">
    <input
      (ngModelChange)="search()"
      [(ngModel)]="searchValue"
      nz-input
      placeholder="Pesquisar recibo ou cliente"
      type="text"/>
  </div>

  <div class="table-wrapper">
    <div class="table-scroll">
      <nz-spin
        [nzSpinning]="isLoading"
        nzSize="large"
        nzTip="A carregar Customer...">
        <nz-table
          #nzTable
          [nzData]="listOfDisplayData"
          [nzScroll]="{ x: '1150px', y: '340px' }"
          nzTableLayout="fixed">
          <thead>
          <tr>
            <th>Código</th>
            <th nzCustomFilter>
              Cliente
              <nz-filter-trigger [(nzVisible)]="visible" [nzActive]="searchValue.length > 0" [nzDropdownMenu]="menu">
                <nz-icon nzType="search"></nz-icon>
              </nz-filter-trigger>
            </th>
            <th>Mês/Ref.</th>
            <th>Total.</th>
            <th>Nome do Ficheiro</th>
            <th>Caminho do Ficheiro</th>
            <th>Data de Criação</th>
            <th>Ações</th>
          </tr>
          </thead>
          <tbody>
          <tr *ngFor="let data of nzTable.data">
            <td>{{ data.invoiceCode }}</td>
            <td>{{ data.customerName }}</td>
            <td>{{ data.monthDescription }}</td>
            <td>{{ data.total }}</td>
            <td>
              {{ data.fileName }}
            </td>

            <td>
              <a (click)="getDownloadUrl(data)"
                 target="_blank">
                {{ data.filePath }}
              </a>
            </td>
            <td>{{ data.createdAt | date: 'dd/MM/yyyy - HH:mm' }}</td>
            <td>
              <button (click)="getDownloadUrl(data)" nz-button nzSize="small" nzType="link">
                <nz-icon nzTheme="outline" nzType="printer"></nz-icon>
              </button>
              <button (click)="deleteRecibo(data)" nz-button nzDanger nzSize="small" nzType="link">
                <nz-icon nzTheme="outline" nzType="delete"></nz-icon>
              </button>
            </td>
          </tr>
          </tbody>
        </nz-table>

      </nz-spin>
    </div>
    <nz-dropdown-menu #menu="nzDropdownMenu">
      <div class="ant-table-filter-dropdown">
        <div class="search-box">
          <input (ngModelChange)="search()" [(ngModel)]="searchValue" nz-input placeholder="Pesquisar" type="text"/>
          <button (click)="search()" class="search-button" nz-button nzSize="small" nzType="primary">Pesquisar</button>
          <button (click)="reset()" nz-button nzSize="small">Limpar</button>
        </div>
      </div>
    </nz-dropdown-menu>
  </div>
</div>

